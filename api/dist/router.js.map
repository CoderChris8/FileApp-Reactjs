{"version":3,"sources":["../src/router.js"],"names":["AppRouter","app","setupRouters","uploadDir","get","upload","req","res","next","status","json","version","post","array","files","fileName","params","name","filePath","path","join","download","err","error","message","console","log"],"mappings":";;;;;;qjBAEwB;;;AAFxB;;AAEA;;;;AACA;;;;;;IAEMA,S;AAEF,uBAAYC,GAAZ,EAAgB;AAAA;;AAAE;;AAEd,aAAKA,GAAL,GAAWA,GAAX;AACA,aAAKC,YAAL;AACH;;;;uCACa;;AAEV,gBAAMD,MAAM,KAAKA,GAAjB;AACA,gBAAME,YAAYF,IAAIG,GAAJ,CAAQ,YAAR,CAAlB,CAHU,CAG+B;AACzC,gBAAMC,SAASJ,IAAIG,GAAJ,CAAQ,QAAR,CAAf,CAJU,CAIwB;;AAElC;AACAH,gBAAIG,GAAJ,CAAQ,GAAR,EAAa,UAACE,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;;AAE7B,uBAAOD,IAAIE,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACxBC,6BAASA;AADe,iBAArB,CAAP;AAIH,aAND;;AASA;AACAV,gBAAIW,IAAJ,CAAS,aAAT,EAAwBP,OAAOQ,KAAP,CAAa,OAAb,CAAxB,EAA8C,UAACP,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC9D,oBAAMM,QAAQR,IAAIQ,KAAlB,CAD8D,CACrC;AACzB,uBAAOP,IAAIG,IAAJ,CAAS;AACZI,2BAAMA;AADM,iBAAT,CAAP;AAGH,aALD;;AAOA;;AAEAb,gBAAIG,GAAJ,CAAQ,qBAAR,EAA+B,UAACE,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAAE;;AAEjD,oBAAMO,WAAWT,IAAIU,MAAJ,CAAWC,IAA5B,CAF+C,CAEb;AAClC,oBAAMC,WAAWC,eAAKC,IAAL,CAAUjB,SAAV,EAAqBY,QAArB,CAAjB,CAH+C,CAGE;;AAEjD,uBAAOR,IAAIc,QAAJ,CAAaH,QAAb,EAAuBH,QAAvB,EAAiC,UAACO,GAAD,EAAS;AAAE;;AAE/C,wBAAGA,GAAH,EAAO;;AAEH,+BAAOf,IAAIE,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;;AAExBa,mCAAO;AACHC,yCAAS;AADN;AAFiB,yBAArB,CAAP;AAMH,qBARD,MAQK;;AAEDC,gCAAQC,GAAR,CAAY,qBAAZ;AACH;AAEJ,iBAfM,CAAP;AAmBH,aAxBD;AA2BH;;;;;;kBAIU1B,S","file":"router.js","sourcesContent":["import { CLIENT_RENEG_LIMIT } from \"tls\";\n\nimport path from 'path' // added 37.57\nimport {version} from '../package.json'\n\nclass AppRouter {\n\n    constructor(app){ // This is coming from the index.js file.\n\n        this.app = app;\n        this.setupRouters();\n    }\n    setupRouters(){\n\n        const app = this.app;\n        const uploadDir = app.get('storageDir'); //<-- Modified and moved\n        const upload = app.get('upload'); //<-- Modified and moved\n\n        // root routing\n        app.get('/', (req, res, next) => {\n            \n            return res.status(200).json({\n                version: version\n            });\n        \n        });\n\n        \n        // Upload routing\n        app.post('/api/upload', upload.array('files'),(req, res, next) => {\n            const files = req.files; // console.log('Received file uploaded', req.files); <-- Commented out\n            return res.json({\n                files:files,\n            })\n        });\n    \n        // Download routing <-- added 35.37\n\n        app.get('/api/download/:name', (req, res, next) => { // <-- added 35.37 (the token -> name)\n\n            const fileName = req.params.name; // <-- added 36.48 \n            const filePath = path.join(uploadDir, fileName); // added 38.24\n\n            return res.download(filePath, fileName, (err) => { // added. 39.21\n\n                if(err){\n\n                    return res.status(404).json({\n\n                        error: {\n                            message: \"File not found\"\n                        }\n                    }); \n                }else{\n\n                    console.log(\"File is downloaded.\");\n                }\n\n            });\n        \n                \n\n        }); \n\n\n    }\n\n}\n\nexport default AppRouter;"]}